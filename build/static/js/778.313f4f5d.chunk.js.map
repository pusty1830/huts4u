{"version":3,"file":"static/js/778.313f4f5d.chunk.js","mappings":"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","sources":["../node_modules/@mui/icons-material/esm/HourglassBottom.js","pages/MyBookings.tsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"m18 22-.01-6L14 12l3.99-4.01L18 2H6v6l4 4-4 3.99V22zM8 7.5V4h8v3.5l-4 4z\"\n}), 'HourglassBottom');","// src/components/MyBookings.tsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport {\r\n  Box,\r\n  Button,\r\n  Card,\r\n  CardContent,\r\n  Dialog,\r\n  DialogContent,\r\n  DialogTitle,\r\n  Divider,\r\n  Grid,\r\n  Rating,\r\n  Typography,\r\n  CircularProgress,\r\n} from \"@mui/material\";\r\nimport { HourglassBottom } from \"@mui/icons-material\";\r\nimport color from \"../components/color\";\r\nimport { CustomTextField } from \"../components/style\";\r\nimport { getUserId } from \"../services/axiosClient\";\r\nimport { getAllMyBookings, createRating, cancelBooking, updateBookings, createCancel } from \"../services/services\";\r\nimport { toast } from \"react-toastify\";\r\n\r\n/**\r\n * ReviewPopup - modal to collect rating + review text\r\n */\r\nconst ReviewPopup = ({ open, handleClose, selectedCard, onSubmit }: any) => {\r\n  const [rating, setRating] = useState<number>(selectedCard?.rating || 0);\r\n  const [review, setReview] = useState<string>(selectedCard?.reviewText || \"\");\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setRating(selectedCard?.rating || 0);\r\n    setReview(selectedCard?.reviewText || \"\");\r\n  }, [selectedCard]);\r\n\r\n  const handleSubmit = async () => {\r\n    if (!selectedCard) return;\r\n    setSaving(true);\r\n    try {\r\n      await onSubmit(selectedCard.id, rating, review);\r\n      handleClose();\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onClose={handleClose} fullWidth maxWidth=\"sm\">\r\n      <DialogTitle sx={{ fontWeight: 700 }}>\r\n        Review - {selectedCard?.hotelName || selectedCard?.title || \"Booking\"}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Box display=\"flex\" flexDirection=\"column\" gap={2} mt={1}>\r\n          <Typography>Rate your experience:</Typography>\r\n          <Rating\r\n            value={rating}\r\n            onChange={(e, newValue) => setRating(newValue || 0)}\r\n            size=\"large\"\r\n          />\r\n          <CustomTextField\r\n            sx={{\r\n              \"& .MuiInputBase-input\": { resize: \"vertical\" },\r\n              \"& textarea\": { resize: \"vertical\" },\r\n              \"& .MuiOutlinedInput-root\": {\r\n                \"& fieldset\": {\r\n                  border: \"none\",\r\n                  borderRadius: \"12px\",\r\n                },\r\n              },\r\n            }}\r\n            label=\"Write your review\"\r\n            multiline\r\n            rows={4}\r\n            fullWidth\r\n            value={review}\r\n            onChange={(e) => setReview(e.target.value)}\r\n          />\r\n\r\n          <Box display=\"flex\" justifyContent=\"flex-end\" gap={2}>\r\n            <Button\r\n              onClick={handleClose}\r\n              variant=\"outlined\"\r\n              sx={{\r\n                textTransform: \"none\",\r\n                borderRadius: \"44px\",\r\n              }}\r\n            >\r\n              Cancel\r\n            </Button>\r\n\r\n            <Button\r\n              onClick={handleSubmit}\r\n              variant=\"contained\"\r\n              sx={{\r\n                background: color.firstColor,\r\n                color: \"white\",\r\n                textTransform: \"none\",\r\n                borderRadius: \"44px\",\r\n                px: 3,\r\n              }}\r\n              disabled={saving}\r\n            >\r\n              {saving ? <CircularProgress size={20} color=\"inherit\" /> : \"Submit Review\"}\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\n/**\r\n * MyBookings component - full page with responsive cards and rating flow\r\n */\r\nconst MyBookings: React.FC = () => {\r\n  const [data, setData] = useState<any[]>([]);\r\n  const [open, setOpen] = useState(false);\r\n  const [selectedCard, setSelectedCard] = useState<any | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const formatCurrency = (amount: number | string) => {\r\n    if (!amount && amount !== 0) return \"₹0.00\";\r\n    let num = Number(amount);\r\n    // If API stores paise, convert large numbers (e.g. > 1000) to rupees\r\n    if (!isNaN(num) && Math.abs(num) > 1000) num = num / 100;\r\n    if (isNaN(num)) return String(amount);\r\n    return num.toLocaleString(\"en-IN\", { style: \"currency\", currency: \"INR\", minimumFractionDigits: 2 });\r\n  };\r\n\r\n  // parse booking date helper (robust)\r\n  const parseBookingDate = (card: any): Date | null => {\r\n    try {\r\n      if (!card) return null;\r\n      if (card.checkInDateTime) {\r\n        const d = new Date(card.checkInDateTime);\r\n        if (!isNaN(d.getTime())) return d;\r\n      }\r\n      if (card.checkInDate) {\r\n        const datePart = String(card.checkInDate).replace(/[\\u2018\\u2019\\u201C\\u201D]/g, \"'\").trim();\r\n        const timePart = card.checkInTime ? String(card.checkInTime).trim() : \"\";\r\n        const attempts = [`${datePart} ${timePart}`, `${datePart}T${timePart}`, datePart];\r\n        for (const s of attempts) {\r\n          if (!s) continue;\r\n          const d = new Date(s);\r\n          if (!isNaN(d.getTime())) return d;\r\n        }\r\n        const cleaned = `${datePart.replace(/’|‘|’/g, \"\")} ${timePart}`.replace(/[\\u2018\\u2019\\u201C\\u201D]/g, \"\");\r\n        const d2 = new Date(cleaned);\r\n        if (!isNaN(d2.getTime())) return d2;\r\n      }\r\n      return null;\r\n    } catch {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  // cancellable if > 24 hours left\r\n  const isCancelable = (card: any) => {\r\n    const bookingDate = parseBookingDate(card);\r\n    if (!bookingDate) return false;\r\n    const now = new Date();\r\n    return bookingDate.getTime() - now.getTime() > 24 * 60 * 60 * 1000;\r\n  };\r\n\r\n  // load bookings\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const Payload = {\r\n          data: { filter: \"\", userId: getUserId() },\r\n          page: 0,\r\n          pageSize: 50,\r\n          order: [[\"createdAt\", \"DESC\"]],\r\n        };\r\n        const res = await getAllMyBookings(Payload);\r\n        const rows = res?.data?.data?.rows || [];\r\n        setData(rows);\r\n      } catch (err) {\r\n        console.error(\"Failed to load bookings\", err);\r\n        toast.error(\"Failed to load bookings\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    load();\r\n  }, []);\r\n\r\n  // auto-open review modal when a booking is checked out and has no rating\r\n  useEffect(() => {\r\n    if (!data || !data.length) return;\r\n    const pendingReview = data.find((b) => String(b.status) === \"checkedOut\" && (b.rating === undefined || b.rating === null));\r\n    if (pendingReview) {\r\n      setSelectedCard(pendingReview);\r\n      setOpen(true);\r\n    }\r\n  }, [data]);\r\n\r\n  const handleOpen = (card: any) => {\r\n    setSelectedCard(card);\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n    setSelectedCard(null);\r\n  };\r\n\r\n  // POST rating to backend\r\n  const handleSubmitReview = async (bookingId: number | string, ratingValue: number, reviewText?: string) => {\r\n    // optimistic local update\r\n    setData((prev) => prev.map((card) => (String(card.id) === String(bookingId) ? { ...card, rating: ratingValue, reviewText } : card)));\r\n\r\n    try {\r\n      const booking = data.find((b) => String(b.id) === String(bookingId));\r\n      const payload = {\r\n        userId: getUserId(),\r\n        hotelId: booking?.hotelId || booking?.hotelId || booking?.hotelId,\r\n        bookingId,\r\n        rating: Number(ratingValue),\r\n        comment: reviewText || \"\",\r\n      };\r\n\r\n      const res = await createRating(payload);\r\n      if (res?.data) {\r\n        const saved = res.data;\r\n        setData((prev) =>\r\n          prev.map((card) =>\r\n            String(card.id) === String(bookingId)\r\n              ? { ...card, rating: saved.rating ?? ratingValue, reviewText: saved.comment ?? reviewText, hasRated: true }\r\n              : card\r\n          )\r\n        );\r\n      }\r\n      toast.success(\"Thanks for your review!\");\r\n    } catch (err: any) {\r\n      console.error(\"Failed to submit rating:\", err);\r\n      // rollback optimistic update\r\n      setData((prev) => prev.map((card) => (String(card.id) === String(bookingId) ? { ...card, rating: undefined, reviewText: undefined } : card)));\r\n      toast.error(err?.message || \"Failed to submit review. Please try again.\");\r\n    }\r\n  };\r\n\r\n  // Cancel booking (optimistic). Replace TODO with your cancel API.\r\n  const handleCancelBooking = async (card: any) => {\r\n    console.log(card)\r\n    if (!isCancelable(card)) {\r\n      toast.info(\"Bookings can only be cancelled more than 24 hours before check-in.\");\r\n      return;\r\n    }\r\n\r\n    const prevStatus = card.status;\r\n    setData((prev) => prev.map((c) => (c.id === card.id ? { ...c, status: \"cancelled\" } : c)));\r\n\r\n    try {\r\n      const payLoad = {\r\n        paymentId: card.paymentId,\r\n        amount: card.amountPaid\r\n      }\r\n      cancelBooking(payLoad).then((res) => {\r\n        // console.log(res)\r\n        const payLoad =\r\n        {\r\n          \"userId\": getUserId(),\r\n          \"hotelId\": card.hotelId,\r\n          \"bookingId\": card.id,\r\n          \"amount\": card.ammountpaid,\r\n          \"refundAmount\": card.ammountpaid,\r\n          \"reason\": \"Guest requested cancellation\",\r\n          \"status\": \"pending\",\r\n          \"refundres\": res?.data?.refund,\r\n          \"processedBy\": 1,\r\n          \"refundedAt\": \"2025-12-04T08:00:00.000Z\",\r\n          \"currency\": \"INR\"\r\n\r\n        }\r\n\r\n        updateBookings(card.id, { status: \"Cancel\" }).then((res) => {\r\n          toast.success(\"Booking cancelled\");\r\n          createCancel(payLoad).then((res) => {\r\n            toast.success(\"Booking cancelled\");\r\n          })\r\n\r\n        })\r\n\r\n      }).catch((err) => {\r\n        console.log(err);\r\n      })\r\n\r\n\r\n\r\n    } catch (err) {\r\n      // rollback\r\n      setData((prev) => prev.map((c) => (c.id === card.id ? { ...c, status: prevStatus } : c)));\r\n      toast.error(\"Failed to cancel booking. Please try again.\");\r\n    }\r\n  };\r\n\r\n  if (loading)\r\n    return (\r\n      <Box sx={{ display: \"flex\", justifyContent: \"center\", py: 6 }}>\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n\r\n  return (\r\n    <Box sx={{ background: color.thirdColor, px: { xs: 2, md: 4 }, py: 4 }}>\r\n      <Typography variant=\"h4\" fontWeight=\"bold\" sx={{ textAlign: \"center\", color: color.firstColor, mb: 2 }}>\r\n        Your Bookings\r\n      </Typography>\r\n\r\n      <Grid container spacing={2}>\r\n        {data.length === 0 && (\r\n          <Grid item xs={12}>\r\n            <Box sx={{ textAlign: \"center\", py: 6 }}>\r\n              <Typography sx={{ color: \"#666\" }}>No bookings yet.</Typography>\r\n            </Box>\r\n          </Grid>\r\n        )}\r\n\r\n        {data.map((card, index) => {\r\n          const cancelEnabled = isCancelable(card);\r\n          return (\r\n            <Grid item xs={12} md={6} key={card.id ?? index}>\r\n              <Card\r\n                sx={{\r\n                  margin: \"auto\",\r\n                  mt: 2,\r\n                  p: { xs: 2, md: 3 },\r\n                  boxShadow: \"0px 8px 28px rgba(0,0,0,0.12)\",\r\n                  borderRadius: \"12px\",\r\n                  border: `1px solid ${color.firstColor}`,\r\n                  position: \"relative\",\r\n                }}\r\n              >\r\n                <CardContent sx={{ p: 0 }}>\r\n                  <Box\r\n                    sx={{\r\n                      position: \"absolute\",\r\n                      top: { xs: 8, md: 8 },\r\n                      right: { xs: 16, md: 16 },\r\n                      background:\r\n                        card.status === \"checked in\" || card.status === \"checked out\"\r\n                          ? \"green\"\r\n                          : card.status === \"pending\"\r\n                            ? \"#faaf00\"\r\n                            : \"red\",\r\n                      color: \"white\",\r\n                      px: 1,\r\n                      borderRadius: { xs: \"6px\", md: \"8px\" },\r\n                      py: 0.5,\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      gap: 1,\r\n                      fontSize: \"12px\",\r\n                      textTransform: \"capitalize\",\r\n                    }}\r\n                  >\r\n                    {card.status}\r\n                  </Box>\r\n\r\n                  <Typography variant=\"h6\" sx={{ fontWeight: 700, mb: 0.5 }}>\r\n                    {card?.hotelName || card?.propertyName || card?.title}\r\n                  </Typography>\r\n\r\n                  <Typography color=\"textSecondary\" sx={{ fontSize: 13 }}>\r\n                    {card?.checkInDate} {card?.checkInTime ? `, ${card.checkInTime}` : \"\"}{\" \"}\r\n                    {card?.guestName ? `· ${card.guestName}` : \"\"}\r\n                  </Typography>\r\n\r\n                  <Typography sx={{ mt: 1 }}>\r\n                    {card?.adults ?? 1} Adults{card?.children ? `, ${card.children} Child` : \"\"}\r\n                  </Typography>\r\n\r\n                  <Typography variant=\"h6\" sx={{ mt: 1 }}>\r\n                    {formatCurrency(card?.amountPaid ?? card?.amount ?? 0)}\r\n                  </Typography>\r\n\r\n                  <Divider sx={{ my: 1.5, borderStyle: \"dashed\", borderColor: \"grey\" }} />\r\n\r\n                  {card.status === \"checkedOut\" && (\r\n                    <Box display=\"flex\" alignItems=\"center\" gap={2} mt={1} flexWrap=\"wrap\">\r\n                      <Button\r\n                        sx={{\r\n                          background: \"transparent\",\r\n                          border: \"solid 2px\",\r\n                          color: color.firstColor,\r\n                          borderColor: color.firstColor,\r\n                          borderRadius: \"44px\",\r\n                          textTransform: \"none\",\r\n                        }}\r\n                        onClick={() => handleOpen(card)}\r\n                      >\r\n                        {card.rating ? \"Edit Review\" : \"Add Review\"}\r\n                      </Button>\r\n                      <Rating value={card.rating ?? 0} readOnly size=\"small\" />\r\n                    </Box>\r\n                  )}\r\n\r\n                  {card.status === \"pending\" && (\r\n                    <Box display=\"flex\" alignItems=\"flex-start\" mt={2} color={\"#faaf00\"}>\r\n                      <HourglassBottom />\r\n                      <Box sx={{ ml: 1, display: \"flex\", alignItems: \"center\", gap: 1, flexWrap: \"wrap\" }}>\r\n                        <Typography>Upcoming</Typography>\r\n                        <Button\r\n                          sx={{\r\n                            background: \"transparent\",\r\n                            border: \"solid 2px\",\r\n                            color: color.firstColor,\r\n                            borderColor: color.firstColor,\r\n                            borderRadius: \"44px\",\r\n                            textTransform: \"none\",\r\n                            ml: 2,\r\n                          }}\r\n                          onClick={() => handleCancelBooking(card)}\r\n                          disabled={!cancelEnabled}\r\n                        >\r\n                          Cancel\r\n                        </Button>\r\n                      </Box>\r\n                    </Box>\r\n                  )}\r\n\r\n                  {card.status === \"cancelled\" && (\r\n                    <Box mt={2} color=\"red\">\r\n                      <Typography>Booking Cancelled</Typography>\r\n                    </Box>\r\n                  )}\r\n                </CardContent>\r\n              </Card>\r\n            </Grid>\r\n          );\r\n        })}\r\n      </Grid>\r\n\r\n      {selectedCard && (\r\n        <ReviewPopup open={open} handleClose={handleClose} selectedCard={selectedCard} onSubmit={handleSubmitReview} />\r\n      )}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MyBookings;\r\n"],"names":["createSvgIcon","_jsx","d","ReviewPopup","_ref","open","handleClose","selectedCard","onSubmit","rating","setRating","useState","review","setReview","reviewText","saving","setSaving","useEffect","_jsxs","Dialog","onClose","fullWidth","maxWidth","children","DialogTitle","sx","fontWeight","hotelName","title","DialogContent","Box","display","flexDirection","gap","mt","Typography","Rating","value","onChange","e","newValue","size","CustomTextField","resize","border","borderRadius","label","multiline","rows","target","justifyContent","Button","onClick","variant","textTransform","async","id","background","color","firstColor","px","disabled","CircularProgress","MyBookings","data","setData","setOpen","setSelectedCard","loading","setLoading","formatCurrency","amount","num","Number","isNaN","Math","abs","String","toLocaleString","style","currency","minimumFractionDigits","isCancelable","card","bookingDate","checkInDateTime","Date","getTime","checkInDate","datePart","replace","trim","timePart","checkInTime","attempts","s","cleaned","d2","parseBookingDate","now","_res$data","_res$data$data","Payload","filter","userId","getUserId","page","pageSize","order","res","getAllMyBookings","err","console","error","toast","load","length","pendingReview","find","b","status","undefined","py","thirdColor","xs","md","textAlign","mb","Grid","container","spacing","item","map","index","_card$id","_card$adults","_ref2","_card$amountPaid","_card$rating","cancelEnabled","Card","margin","p","boxShadow","position","CardContent","top","right","alignItems","fontSize","propertyName","guestName","adults","amountPaid","Divider","my","borderStyle","borderColor","flexWrap","handleOpen","readOnly","HourglassBottom","ml","log","info","prevStatus","prev","c","payLoad","paymentId","cancelBooking","then","_res$data2","hotelId","ammountpaid","refund","updateBookings","success","createCancel","catch","handleCancelBooking","bookingId","ratingValue","booking","payload","comment","createRating","saved","_saved$rating","_saved$comment","hasRated","message"],"sourceRoot":""}