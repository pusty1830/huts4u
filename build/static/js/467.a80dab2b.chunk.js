"use strict";(self.webpackChunkhuts4u=self.webpackChunkhuts4u||[]).push([[467],{43464:(e,o,t)=>{t.r(o),t.d(o,{default:()=>O});var n=t(7353),i=t(12110),r=t(26494),l=t(94496),a=t(36591),s=t(39336),d=t(60446),c=t.n(d),u=t(13892),h=t(65043),m=t(17195),x=t.n(m),p=t(73216),v=t(57488),f=t(80899),g=t(31716),b=t(69995),y=t(59007),j=t(83462),k=t(26600),A=t(35316),S=t(29347),w=t(11906),C=t(33580),D=t(59628),Y=t(70579);const R=e=>{let{orderDetails:o,bookingDetails:t}=e;console.log(t);const n=(0,p.Zp)(),[i,r]=(0,h.useState)(!0),l=()=>r(!1);return(0,Y.jsx)("div",{children:(0,Y.jsxs)(j.A,{open:i,onClose:l,maxWidth:"xs",fullWidth:!0,sx:{"& .MuiPaper-root":{padding:"8px",borderRadius:"16px"}},children:[(0,Y.jsx)(k.A,{children:"Complete Your Payment"}),(0,Y.jsx)(A.A,{children:(0,Y.jsx)("p",{children:"Ensure your payment details are correct before proceeding."})}),(0,Y.jsxs)(S.A,{style:{display:"flex",justifyContent:"flex-end"},children:[(0,Y.jsx)(w.A,{style:{textTransform:"none",color:"black"},onClick:l,children:"Cancel"}),(0,Y.jsx)(w.A,{onClick:async()=>{var e;if(!await(e="https://checkout.razorpay.com/v1/checkout.js",new Promise((o=>{const t=document.createElement("script");t.src=e,t.onload=()=>o(!0),t.onerror=()=>o(!1),document.body.appendChild(t)})))||!window.Razorpay)return void alert("Failed to load Razorpay SDK.");const i={key:y.tz||"",amount:o.data.amount,currency:o.data.currency,order_id:o.data.id,handler:async e=>{try{var i,r,l,a,s,d,c;await(0,b.KF)({orderId:e.razorpay_order_id,paymentId:e.razorpay_payment_id,signature:e.razorpay_signature}),alert("Payment Successful");const u={userId:(0,D.F6)(),hotelId:null===t||void 0===t||null===(i=t.hotel)||void 0===i?void 0:i.id,geustName:null===t||void 0===t||null===(r=t.guestInfo)||void 0===r?void 0:r.name,amountPaid:o.data.amount,checkInDate:null===t||void 0===t||null===(l=t.timing)||void 0===l?void 0:l.checkInDate,checkInTime:null===t||void 0===t||null===(a=t.timing)||void 0===a?void 0:a.checkInTime,checkOutDate:null===t||void 0===t||null===(s=t.timing)||void 0===s?void 0:s.checkOutDate,checkOutTime:null===t||void 0===t||null===(d=t.timing)||void 0===d?void 0:d.checkOutTime,bookingType:null===t||void 0===t?void 0:t.bookingType,geustDetails:null===t||void 0===t?void 0:t.guestInfo,adults:null===t||void 0===t?void 0:t.adults,children:null===t||void 0===t?void 0:t.children,hotelName:null===t||void 0===t||null===(c=t.hotel)||void 0===c?void 0:c.propertyName,status:"pending"};(0,b.UY)(u).then((e=>{var o;(0,v.oR)(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.msg)})).catch((e=>{console.log(e)})),n("/my-bookings")}catch(u){alert("Payment verification failed. Please try again.")}}};new window.Razorpay(i).open()},variant:"contained",style:{background:C.A.firstColor,fontSize:"18px",textTransform:"none",border:"solid 1px white"},sx:{padding:"2px 10px",transition:"all 0.4s ease","&:hover":{paddingRight:"20px"}},children:"Proceed to Pay"})]})]})})};var M=t(67809),P=t(83560),I=t(53062),N=t(68903),T=t(67784);t(73337);const z={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",maxWidth:400,width:"90%",height:240,background:C.A.thirdColor,borderRadius:"12px"},W=e=>{let{open:o,onClose:t,onVerificationSuccess:i,phone:r,name:a,email:s,token:d}=e;const[c,u]=(0,h.useState)(1),[m,x]=(0,h.useState)(""),[f,g]=(0,h.useState)("in"),[y,j]=(0,h.useState)(""),k=(0,p.Zp)(),A=(0,p.zy)(),[S,R]=(0,h.useState)(Array(4).fill("")),M=Array.from({length:4},(()=>(0,h.useRef)(null)));new URLSearchParams(A.search).get("login");return(0,Y.jsx)(I.A,{open:o,onClose:t,children:(0,Y.jsx)(n.A,{sx:z,children:(0,Y.jsx)(Y.Fragment,{children:(0,Y.jsxs)("div",{className:"subscribe",style:{background:C.A.background,color:"white",position:"relative",boxShadow:"-4px -4px 10px rgba(255, 255, 255, 0.36) inset",borderRadius:"12px",overflow:"hidden"},children:[(0,Y.jsx)(n.A,{sx:{background:"url('/assets/footer.webp')",backgroundSize:{xs:"70%",md:"70%"},backgroundRepeat:"no-repeat",backgroundPosition:"bottom left",position:"absolute",top:0,left:0,width:"100%",height:"100%"}}),(0,Y.jsx)(l.A,{variant:"h6",children:"Enter OTP"}),(0,Y.jsxs)(l.A,{variant:"body2",sx:{mb:1},children:["Sent to: +",r," ",(0,Y.jsxs)(w.A,{size:"small",onClick:()=>(()=>{const e=new URLSearchParams(A.search);e.delete("login"),e.delete("phone"),e.delete("name"),e.delete("email"),e.delete("token"),k(`${A.pathname}?${e.toString()}`,{replace:!0,state:{...A.state}})})(),sx:{color:C.A.firstColor,background:C.A.thirdColor,p:0,px:1,minWidth:0,ml:1,textTransform:"none"},children:[(0,Y.jsx)(P.A,{sx:{fontSize:"14px"}})," Edit"]})]}),(0,Y.jsx)(N.Ay,{container:!0,spacing:1,justifyContent:"center",mt:3,children:S.map(((e,o)=>(0,Y.jsx)(N.Ay,{item:!0,children:(0,Y.jsx)(T.A,{inputRef:M[o],value:S[o],onChange:e=>((e,o)=>{if(!/^\d*$/.test(o))return;const t=[...S];var n;t[e]=o,R(t),o&&e<3&&(null===(n=M[e+1].current)||void 0===n||n.focus())})(o,e.target.value),inputProps:{maxLength:1,style:{textAlign:"center",fontSize:18,borderColor:"transparent"}},sx:{width:40,bgcolor:C.A.thirdColor,borderRadius:2,border:"none",outline:"none",boxShadow:"none","& fieldset":{border:"none"},"&:hover":{bgcolor:"#f5f5f5"},"& .MuiInputBase-input":{color:C.A.firstColor,fontFamily:"CustomFontB",fontSize:"20px"}}})},o)))}),(0,Y.jsx)(w.A,{onClick:()=>{4===S.join("").length&&(0,b.vJ)({otp:S.join(""),sessionId:d,phone:r,name:a,email:s}).then((e=>{var o,n,r,l;(0,D.p$)(null===e||void 0===e||null===(o=e.data)||void 0===o||null===(n=o.data)||void 0===n?void 0:n.token),(0,D.lt)(null===e||void 0===e||null===(r=e.data)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.user),v.oR.success("Verified successfully!"),i(),t()})).catch((e=>{v.oR.error("Verification failed")}))},type:"submit",sx:{background:C.A.thirdColor,color:C.A.firstColor,fontSize:"14px",fontWeight:"bold",textTransform:"none",m:"auto",mt:4,width:"100%",display:"block",position:"absolute",bottom:0,left:0,borderRadius:0,py:2,boxShadow:"0px -6px 50px rgba(7, 7, 7, 0.11)"},children:"Verify OTP"})]})})})})},F=f.Ik({name:f.Yj().required("Name is required"),email:f.Yj().email("Invalid email").optional()}),O=()=>{var e,o,t,d,m;const f=(0,p.zy)(),y=null===(e=f.state)||void 0===e?void 0:e.hotelData,j=null===(o=f.state)||void 0===o?void 0:o.selectedRoom,k=null===(t=f.state)||void 0===t?void 0:t.selectedSlot,A=null===(d=f.state)||void 0===d?void 0:d.pricingDetails,S=new URLSearchParams(f.search),w=S.get("bookingType"),P=S.get("time"),I=S.get("checkinDate"),N=S.get("checkOutDate"),T=S.get("rooms"),z=S.get("adults"),O=S.get("children"),$=null===k||void 0===k?void 0:k.slot,E=null===$||void 0===$||null===(m=$.match(/\d+/))||void 0===m?void 0:m[0],V=E?parseInt(E,10):null,[L,_]=(0,h.useState)({});(0,h.useEffect)((()=>{(0,D.M3)()&&(0,b.E$)().then((e=>{var o;_(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.data)})).catch((e=>{console.log(e)}))}),[]);const[H,U]=(0,h.useState)(!1),[G,X]=(0,h.useState)({phone:"",name:"",email:"",token:""}),[Z,q]=(0,h.useState)(null),J=Number(null===A||void 0===A?void 0:A.totalPrice)||0,K=async()=>{try{if(!J||J<=0)return void alert("Booking amount cannot be zero.");const e={amount:J,currency:"INR"},o=await(0,b.fS)(e);null!==o&&void 0!==o&&o.data?q(o.data):alert("Payment failed. Please try again.")}catch(e){console.error("Error during payment:",e),alert("Payment failed. Please try again.")}},Q=((0,p.Zp)(),(0,u.Wx)({initialValues:{name:L.userName||"",email:L.email||"",phoneNumber:`91${L.phoneNumber}`||""},validationSchema:F,enableReinitialize:!0,onSubmit:e=>{if((0,D.M3)())K();else{const o={name:e.name,email:e.email,phone:e.phoneNumber.slice(2)};(0,b.AJ)(o).then((o=>{var t;console.log(o),U(!0),(0,v.oR)("Otp send Succesfully please verify the OTP"),X({phone:e.phoneNumber.slice(2),name:e.name,email:e.email,token:null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.data})})).catch((e=>{console.log(e)}))}}})),ee=(0,h.useRef)(null),[oe,te]=(0,h.useState)("auto");(0,h.useEffect)((()=>{ee.current&&te(`${ee.current.clientHeight}px`)}),[y]);const ne=Number(null===A||void 0===A?void 0:A.basePrice)||0,ie=(Number(null===A||void 0===A?void 0:A.platformFee)||0)+(Number(null===A||void 0===A?void 0:A.gstTotal)||0)+(Number(null===A||void 0===A?void 0:A.extraFees)||0),re=Number(null===A||void 0===A?void 0:A.totalPrice)||ne+ie;return(0,Y.jsxs)(n.A,{sx:{...M.VX,background:"#f6f6f6",mt:0,py:4,px:{xs:1,md:3},display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"center",gap:"20px"},children:[(0,Y.jsx)(i.A,{sx:{p:1,background:"white",maxWidth:"700px",border:"none",boxShadow:0,borderRadius:"12px"},children:(0,Y.jsxs)(r.A,{children:[(0,Y.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:C.A.firstColor,fontWeight:"bold"},children:"Your Booking Summary"}),(0,Y.jsxs)(n.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:{xs:0,md:2},position:"relative",mt:2,height:"fit-content",alignItems:"stretch"},children:[(0,Y.jsx)(a.A,{component:"img",sx:{width:{xs:"100%",md:"250px"},borderRadius:"12px",objectFit:"cover",height:oe,transition:"height 0.3s ease"},image:null===y||void 0===y?void 0:y.propertyImages[0]}),(0,Y.jsxs)("div",{style:{height:"fit-content"},ref:ee,children:[(0,Y.jsx)(l.A,{sx:{fontSize:"20px",fontWeight:600,color:C.A.firstColor,mt:{xs:1.5,md:1},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:null===y||void 0===y?void 0:y.propertyName}),(0,Y.jsx)(l.A,{sx:{fontFamily:"CustomFontSB",fontSize:{xs:"12px",md:"14px"},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},children:null===y||void 0===y?void 0:y.address}),(0,Y.jsxs)("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",flexDirection:"column",gap:"4px"},children:["hourly"===w?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Check-In:"})," ",c()(I).format("DD MMM YYYY"),","," ",P?c()(P,"HH:mm").format("hh:mm A"):""]}),(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Duration: "}),V," hrs"]})]}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Check-In:"})," ",c()(I).format("DD MMM YYYY")]}),(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Check-Out:"})," ",c()(N).format("DD MMM YYYY")]})]}),(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Room Type:"})," ",null===j||void 0===j?void 0:j.roomCategory]}),(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Room Info: "}),T," Room, ",z," Adults, ",O," Children"]})]})]})]}),(0,Y.jsxs)("form",{onSubmit:Q.handleSubmit,children:[(0,Y.jsx)(l.A,{variant:"h6",mt:4,sx:{color:C.A.firstColor,fontWeight:"bold"},children:"Guest Information"}),(0,Y.jsx)(M.XY,{label:"Guest Name",name:"name",fullWidth:!0,margin:"normal",value:Q.values.name,onChange:Q.handleChange,onBlur:Q.handleBlur,error:Q.touched.name&&Boolean(Q.errors.name)}),(0,Y.jsxs)(n.A,{mt:1,children:[(0,Y.jsx)(x(),{country:"in",value:Q.values.phoneNumber,onChange:e=>Q.setFieldValue("phoneNumber",e),onBlur:()=>Q.setFieldTouched("phoneNumber",!0),inputStyle:{width:"100%",height:"56px",borderRadius:"52px",border:"none",boxShadow:"4px 4px 10px rgba(104, 39, 184, 0.17)",color:C.A.firstColor,paddingLeft:"58px",fontSize:"16px",backgroundColor:"white",transition:"border-color 0.2s ease"},buttonStyle:{borderRadius:"52px 0 0 52px",margin:"5px",backgroundColor:"white"},containerStyle:{width:"100%"}}),Q.touched.phoneNumber&&Q.errors.phoneNumber&&(0,Y.jsx)(l.A,{sx:{color:"red",fontSize:"12px",mt:.5,ml:"14px"},children:Q.errors.phoneNumber})]}),(0,Y.jsx)(M.XY,{label:"Email Address (Optional)",name:"email",fullWidth:!0,margin:"normal",value:Q.values.email,onChange:Q.handleChange,onBlur:Q.handleBlur,error:Q.touched.email&&Boolean(Q.errors.email)}),(0,D.M3)()?(0,Y.jsx)(g.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},type:"submit",children:"Pay Now"}):(0,Y.jsx)(g.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},type:"submit",children:"verify Phone & Pay"}),(0,Y.jsx)(W,{open:H,onClose:()=>U(!1),onVerificationSuccess:()=>{U(!1),K()},phone:G.phone,name:G.name,email:G.email,token:G.token}),Z&&(0,Y.jsx)(R,{orderDetails:Z,amount:re,bookingDetails:{hotel:y,room:j,guestInfo:Q.values,timing:(()=>{if("hourly"===w&&P&&V){const e=c()(`${I} ${P}`),o=e.add(V,"hour");return{checkInDate:e.format("DD MMM YYYY"),checkInTime:e.format("hh:mm A"),checkOutDate:o.format("DD MMM YYYY"),checkOutTime:o.format("hh:mm A"),duration:`${V} hrs`}}return{checkInDate:c()(I).format("DD MMM YYYY"),checkInTime:"12.00 PM",checkOutDate:c()(N).format("DD MMM YYYY"),checkOutTime:"11.00 AM",duration:c()(N).diff(c()(I),"day")+1+" night(s)"}})(),pricingDetails:A,bookingType:w,rooms:T,adults:z,children:O}})]})]})}),(0,Y.jsx)(i.A,{sx:{p:1,background:"white",border:"none",boxShadow:0,borderRadius:"12px",height:"fit-content"},children:(0,Y.jsxs)(r.A,{children:[(0,Y.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{color:C.A.firstColor,fontWeight:"bold"},children:"Your Bill Summary"}),(0,Y.jsxs)("div",{style:{marginTop:"10px",display:"flex",flexWrap:"wrap",flexDirection:"column",gap:"4px"},children:[(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Room price: "}),"\u20b9",ne.toFixed(0)]}),(0,Y.jsxs)(l.A,{sx:B,children:[(0,Y.jsx)("strong",{children:"Fees & GST: "}),"\u20b9",ie.toFixed(0)]}),(0,Y.jsx)(s.A,{sx:{my:2}}),(0,Y.jsxs)(l.A,{variant:"h6",sx:{color:C.A.firstColor,fontWeight:"bold",lineHeight:1},children:["Total price: \u20b9",re.toFixed(0)," ",(0,Y.jsx)("br",{}),(0,Y.jsx)("span",{style:{fontSize:"12px",fontWeight:"normal"},children:"incl. of all taxes"})]})]})]})})]})},B={borderRadius:"52px",boxShadow:"4px 4px 10px rgba(104, 39, 184, 0.17)",color:C.A.firstColor,background:"white",fontSize:{xs:"12px",md:"14px"},width:"fit-content",p:1,px:2,mb:1}}}]);
//# sourceMappingURL=467.a80dab2b.chunk.js.map